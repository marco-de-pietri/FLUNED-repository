
def get_isotope_data():
    """
    get some hard coded data for isotopes found in activated water
    It returns a dictionary with the following keys
    - name: the name of the isotope
    - decay constant: the decay constant of the isotope
    - branching ratio: the branching ratio of the isotope
    - energy spectrum: the energy spectrum of the isotope
    - emitting particle: the emitting particle considered
    """




    isotopes = {
        'n16': {
            'name': 'N-16',
            'decay_constant': 0.09721559,
            'energy_spectrum':[
             [0.0000000e+00,0          ],
             [9.8649013e-01,3.49995E-05],
             [9.8650986e-01,0          ],
             [1.7549824e+00,0.00140000],
             [1.7550175e+00,0          ],
             [1.9547805e+00,0.00040000],
             [1.9548195e+00,0          ],
             [2.7414726e+00,0.00840000],
             [2.7415274e+00,0          ],
             [2.8224718e+00,1.3000E-05],
             [2.8225282e+00,0          ],
             [6.0481395e+00,0.00013000],
             [6.0482605e+00,0          ],
             [6.1291087e+00,0.688000],
             [6.1292313e+00,0          ],
             [6.9154308e+00,0.00040000],
             [6.9155692e+00,0          ],
             [7.1150788e+00,0.05000],
             [7.1152212e+00,0          ],
             [8.8691113e+00,0.00080000],
             [8.8692887e+00,0]
             ],
            'energy_spectrum_normalized':[
             [0.0000000e+00,0          ],
             [9.8649013e-01,8.23616E-01],
             [9.8650986e-01,0          ],
             [1.7549824e+00,3.29451E-04],
             [1.7550175e+00,0          ],
             [1.9547805e+00,9.41289E-05],
             [1.9548195e+00,0          ],
             [2.7414726e+00,1.97671E-03],
             [2.7415274e+00,0          ],
             [2.8224718e+00,3.05919E-06],
             [2.8225282e+00,0          ],
             [6.0481395e+00,3.05919E-05],
             [6.0482605e+00,0          ],
             [6.1291087e+00,1.61902E-01],
             [6.1292313e+00,0          ],
             [6.9154308e+00,9.41289E-05],
             [6.9155692e+00,0          ],
             [7.1150788e+00,1.17661E-02],
             [7.1152212e+00,0          ],
             [8.8691113e+00,1.88258E-04],
             [8.8692887e+00,0]
             ],
            'emitting_particle': 'photon',
            # 'e_lines': [
            #     8.67700E-01,
            #     9.86930E-01,
            #     1.75490E+00,
            #     1.95470E+00,
            #     2.74150E+00,
            #     2.82220E+00,
            #     6.12863E+00,
            #     6.91550E+00,
            #     7.11515E+00,
            #     8.86930E+00
            # ],
            # 'p_lines': [
            #     2.10E-06,
            #     3.40E-05,
            #     1.21E-03,
            #     3.80E-04,
            #     8.20E-03,
            #     1.30E-03,
            #     6.70E-01,
            #     3.80E-04,
            #     4.90E-02,
            #     7.60E-04
            # ],
            'e_lines': [
                9.8650E-01,
                1.7550E+00,
                1.95480E+00,
                2.74150E+00,
                2.82250E+00,
                6.04820E+00,
                6.129170E+00,
                6.91550E+00,
                7.11515E+00,
                8.86920E+00
            ],
            'p_lines': [
                3.50E-05,
                1.40E-03,
                4.00E-04,
                8.40E-03,
                1.30E-05,
                1.30E-04,
                6.88E-01,
                4.00E-04,
                5.00E-02,
                8.00E-04
            ],
            'de_lines': [
                3.00E-06,
                1.00E-03,
                1.00E-03,
                6.00E-06,
                1.50E-03,
                1.00E-03,
                4.00E-07,
                6.00E-06,
                6.00E-04,
                1.40E-04,
                5.00E-04,
            ],
            'data_source': 'jeff-3.3'

        },
        'n17': {
            'name': 'N-17',
            'decay_constant': 0.1661825,
            'energy_spectrum':[
                     [0.0000000    ,0.0    ],
                     [0.3859999    ,0.377  ],
                     [0.3860001    ,0.0    ],
                     [0.8859999    ,0.006  ],
                     [0.8860001    ,0.0    ],
                     [1.1629999    ,0.498  ],
                     [1.1630001    ,0.0    ],
                     [1.6889999    ,0.069  ],
                     [1.6890001    ,0.0    ],
                     [3.6139999    ,0.00024],
                     [3.6140001    ,0.0    ],
                     [3.8199999    ,0.00012],
                     [3.8200001    ,0.0    ],
             ],
            'energy_spectrum_normalized':[
                     [0.0000000    ,0.0    ],
                     [0.3859999    ,3.96692E-01],
                     [0.3860001    ,0.0    ],
                     [0.8859999    ,6.31340E-03],
                     [0.8860001    ,0.0    ],
                     [1.1629999    ,5.24012E-01],
                     [1.1630001    ,0.0    ],
                     [1.6889999    ,7.26041E-02],
                     [1.6890001    ,0.0    ],
                     [3.6139999    ,2.52536E-04],
                     [3.6140001    ,0.0    ],
                     [3.8199999    ,1.26268E-04],
                     [3.8200001    ,0.0    ],
             ],
            'emitting_particle': 'neutron',
            'e_lines': [
                3.82800E-01,
                8.84000E-01,
                1.17090E+00,
                1.70030E+00
            ],
            'p_lines': [
                3.48066E-01,
                5.70600E-03,
                5.27805E-01,
                7.03740E-02
            ],
            'de_lines': [
                9.00E-04,
                2.10E-02,
                8.00E-04,
                1.70E-03
            ],
            'data_source': 'endf/b-viii.0'
        },
        'o19': {
            'name': 'O-19',
            'decay_constant': 0.02578672546,
            'energy_spectrum':[
                     [0.0000000e+00,0          ],
                     [1.0989890e-01,0.019048696],
                     [1.0990110e-01,0          ],
                     [1.9719803e-01,0.608294369],
                     [1.9720197e-01,0          ],
                     [1.3569864e+00,0.34351231 ],
                     [1.3570136e+00,0          ],
                     [1.4439856e+00,0.019048696],
                     [1.4440144e+00,0          ],
                     [1.5539845e+00,0.008889519],
                     [1.5540155e+00,0          ],
                     [1.5969840e+00,0.000190487],
                     [1.5970160e+00,0          ],
                     [2.5819742e+00,0.000190487],
                     [2.5820258e+00,0          ],
                     [4.1789582e+00,0.000825437],
                     [4.1790418e+00,0          ],
             ],
            'energy_spectrum_normalized':[
                     [0.0000000e+00,0          ],
                     [1.0989890e-01,0.019048696],
                     [1.0990110e-01,0          ],
                     [1.9719803e-01,0.608294369],
                     [1.9720197e-01,0          ],
                     [1.3569864e+00,0.34351231 ],
                     [1.3570136e+00,0          ],
                     [1.4439856e+00,0.019048696],
                     [1.4440144e+00,0          ],
                     [1.5539845e+00,0.008889519],
                     [1.5540155e+00,0          ],
                     [1.5969840e+00,0.000190487],
                     [1.5970160e+00,0          ],
                     [2.5819742e+00,0.000190487],
                     [2.5820258e+00,0          ],
                     [4.1789582e+00,0.000825437],
                     [4.1790418e+00,0          ],
             ],
            'emitting_particle': 'photon',
            'e_lines': [
                1.09894E-01,
                1.97142E-01,
                1.14900E+00,
                1.23600E+00,
                1.35684E+00,
                1.44409E+00,
                1.55397E+00,
                2.35398E+00,
                2.58252E+00,
                3.71064E+00,
                3.79787E+00,
                3.90774E+00,
                4.18006E+00
            ],
            'p_lines': [
                2.540E-02,
                9.590E-01,
                5.000E-06,
                1.700E-04,
                5.040E-01,
                2.640E-02,
                1.390E-02,
                1.810E-05,
                1.890E-04,
                1.100E-05,
                1.330E-05,
                3.840E-05,
                7.920E-04
            ],
            'de_lines': [
                5.00E-06,
                4.00E-06,
                2.00E-04,
                2.00E-04,
                8.00E-06,
                1.00E-05,
                8.00E-06,
                2.60E-04,
                3.30E-05,
                2.00E-04,
                2.00E-04,
                2.00E-04,
                4.10E-05
            ],
            'data_source': 'endf/b-viii.0'
        }
    }

    for isotope in isotopes.values():
        isotope['branching_ratio'] = sum([x for x in isotope['p_lines']])
        isotope['p_lines_norm'] = [x/isotope['branching_ratio'] for x in isotope['p_lines']]
        e_bins, p_bins = get_bins_from_lines(isotope['e_lines'],isotope['p_lines'])
        isotope['e_bins'] = e_bins
        isotope['p_bins'] = p_bins


    return isotopes


def get_bins_from_lines(energy,prob,eps=1e-5):
    """
    convert the enegy lines to bins
    """
    eb_vals = [0.0]
    for ener in energy:
        dl_val = ener*eps
        eb_vals.append(ener-dl_val)
        eb_vals.append(ener+dl_val)
    pb_vals = []
    for p_val in prob:
        pb_vals.append(0.0)
        pb_vals.append(p_val)
    return eb_vals,pb_vals
